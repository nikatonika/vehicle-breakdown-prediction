# Vehicle Breakdown Prediction

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–æ—É—Ç–±—É–∫–∏ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—é –ø–æ–ª–æ–º–æ–∫ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π. –ó–∞–¥–∞—á–∞ —Ä–µ—à–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è –∞–Ω—Å–∞–º–±–ª–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

## üöó –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

–ú—ã —Ä–µ—à–∞–µ–º –∑–∞–¥–∞—á—É –¥–ª—è –∫–∞—Ä—à–µ—Ä–∏–Ω–≥–æ–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–∏, –∫–æ—Ç–æ—Ä–∞—è —Ö–æ—á–µ—Ç —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–π –º–∞—à–∏–Ω –∏–∑-–∑–∞ –ø–æ–ª–æ–º–æ–∫. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å:
- **–≤—Ä–µ–º—è –¥–æ –ø–æ–ª–æ–º–∫–∏** (—Ä–µ–≥—Ä–µ—Å—Å–∏—è);
- **—Ç–∏–ø –ø–æ–ª–æ–º–∫–∏** (–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è).

–¶–µ–ª—å: **—Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –º–∞—à–∏–Ω –¥–ª—è –æ—Å–º–æ—Ç—Ä–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –±—Ä–∏–≥–∞–¥–æ–π**.


## üìÇ –î–∞–Ω–Ω—ã–µ

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è 4 –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö:

1. `car_train.csv` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –º–∞—à–∏–Ω–∞–º–∏ –∏ —Ç–∞—Ä–≥–µ—Ç–∞–º–∏
2. `rides_info.csv` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–µ–∑–¥–∫–∞—Ö
3. `driver_info.csv` ‚Äî –¥–∞–Ω–Ω—ã–µ –æ –≤–æ–¥–∏—Ç–µ–ª—è—Ö
4. `fix_info.csv` ‚Äî –∏—Å—Ç–æ—Ä–∏—è —Ä–µ–º–æ–Ω—Ç–æ–≤

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
.
‚îú‚îÄ‚îÄ data
‚îÇ   ‚îú‚îÄ‚îÄ car_ids_test.csv
‚îÇ   ‚îú‚îÄ‚îÄ car_test_final.csv
‚îÇ   ‚îú‚îÄ‚îÄ car_train_enriched.csv
‚îÇ   ‚îú‚îÄ‚îÄ car_train_filtered.csv
‚îÇ   ‚îú‚îÄ‚îÄ car_train_full.csv
‚îÇ   ‚îú‚îÄ‚îÄ car_train_merged.csv
‚îÇ   ‚îú‚îÄ‚îÄ links_with_models.csv
‚îÇ   ‚îú‚îÄ‚îÄ mean_salary_by_city_sorted.csv
‚îÇ   ‚îî‚îÄ‚îÄ submission.csv
‚îú‚îÄ‚îÄ models
‚îÇ   ‚îî‚îÄ‚îÄ weighted_soft_top3.pkl
‚îú‚îÄ‚îÄ Competitive_DS_Zaslavskaia_V_All_Tasks.ipynb
‚îî‚îÄ‚îÄ README.md

## üî¢ –≠—Ç–∞–ø—ã –ø—Ä–æ–µ–∫—Ç–∞ 

### ‚úÖ –î–ó 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã 20+ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ `rides_info`, `driver_info`, `fix_info`
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –º–µ—Ç–æ–¥—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
  - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
  - –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è Phik
  - Permutation Importance (Random Forest)
  - SHAP
  - Feature Importance (CatBoost)
- –û—Ç–æ–±—Ä–∞–Ω—ã 12 –∫–ª—é—á–µ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ + —á–∏—Å–ª–æ–≤—ã–µ)

### ‚úÖ –î–ó 2: –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `CatBoostClassifier`
- –ü—Ä–æ–≤–µ–¥–µ–Ω–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/valid
- –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞: `accuracy ‚âà 0.974`
- –ü–æ—Å—Ç—Ä–æ–µ–Ω—ã –≥—Ä–∞—Ñ–∏–∫–∏ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, confusion matrix, SHAP waterfall plot

### ‚úÖ –î–ó 3: –¢—é–Ω–∏–Ω–≥ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ `Optuna`
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã `iterations`, `depth`, `learning_rate`, `l2_leaf_reg`
- –£–ª—É—á—à–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏: `+0.0021` (accuracy ‚âà 0.9765)
- –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ `eval_set` –∏ `early_stopping_rounds`

### ‚úÖ –î–ó 4: –ë–ª–µ–Ω–¥–∏–Ω–≥ –º–æ–¥–µ–ª–µ–π
- –û–±—É—á–µ–Ω—ã –∏ –æ—Ç—Ç—é–Ω–∏–Ω–≥–æ–≤–∞–Ω—ã 4 –º–æ–¥–µ–ª–∏:
  - `CatBoostClassifier`
  - `LGBMClassifier` (goss)
  - `XGBClassifier` (dart)
  - `RandomForestClassifier`
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:
  - Hard Voting (–±–µ–∑ CatBoost ‚Äî –æ–Ω –º–µ—à–∞–ª –∞–Ω—Å–∞–º–±–ª—é)
  - Soft Voting (—Å CatBoost –∏ –±–µ–∑ –Ω–µ–≥–æ)
- –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–∞–ª `XGBoost` –æ—Ç–¥–µ–ª—å–Ω–æ: **accuracy = 0.9786**
- –ê–Ω—Å–∞–º–±–ª—å –∏–∑ `XGB + LGBM + RF` –¥–∞–ª **accuracy = 0.9765**

### ‚úÖ –î–ó 5: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
- Weighted Soft Voting (—Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º XGB)
- StackingClassifier

## üî∫ –§–∏–Ω–∞–ª—å–Ω—ã–µ –≤—ã–≤–æ–¥—ã

- –ù–∞–∏–ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∫–∞–∑–∞–ª `XGBoost` —Å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–º –æ–±—É—á–µ–Ω–∏–µ–º
- –ü—Ä–∏–∑–Ω–∞–∫–∏, –≤–∞–∂–Ω—ã–µ –ø–æ –≤—Å–µ–º –º–µ—Ç—Ä–∏–∫–∞–º: `max_speed`, `avg_destroy_degree`, `speed_avg_mean`, `driver_accident_mean`, `mean_rating`
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø–æ–ª–µ–∑–Ω—ã, –Ω–æ —Ç–æ–ª—å–∫–æ –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
- –ë–ª–µ–Ω–¥–∏–Ω–≥ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω, –µ—Å–ª–∏ –º–æ–¥–µ–ª–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫–æ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã

## üèãÔ∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

```python
numpy==1.26.4
pandas
matplotlib
seaborn
catboost
shap
optuna
phik
lightgbm
xgboost
scikit-learn
```

## üìÅ –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ `data/`

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `car_ids_test.csv` | –°–ø–∏—Å–æ–∫ ID –º–∞—à–∏–Ω –∏–∑ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–∞–±–º–∏—Ç–∞ |
| `car_test_final.csv` | –§–∏–Ω–∞–ª—å–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ —Å –Ω—É–∂–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏, –≥–æ—Ç–æ–≤–∞—è –∫ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å—É –º–æ–¥–µ–ª–µ–π |
| `car_train_enriched.csv` | –û–±–æ–≥–∞—â—ë–Ω–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞, –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–∞—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –∑–∞—Ä–ø–ª–∞—Ç–∞–º –∏–ª–∏ –¥—Ä—É–≥–∏–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º) |
| `car_train_filtered.csv` | –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ –ø–æ—Å–ª–µ –æ—Ç–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–ø–æ SHAP, Permutation, Phik) |
| `car_train_full.csv` | –ü–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–≥–æ —Å–µ—Ç–∞ –ø–æ—Å–ª–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –¥–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ |
| `car_train_merged.csv` | –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü (`car_train`, `rides_info`, `driver_info`, `fix_info`) |
| `links_with_models.csv` | –¢–∞–±–ª–∏—Ü–∞ —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Å–∞–π—Ç–æ–≤ |
| `mean_salary_by_city_sorted.csv` | –°–ø—Ä–∞–≤–æ—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ —Å—Ä–µ–¥–Ω–µ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π –ø–æ –≥–æ—Ä–æ–¥–∞–º, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –ø—Ä–∏ –æ–±–æ–≥–∞—â–µ–Ω–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞ |
| `submission.csv` | –§–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏ –∫–ª–∞—Å—Å–æ–≤ –ø–æ–ª–æ–º–∫–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ Kaggle |


**–ê–≤—Ç–æ—Ä:** –ù–∏–∫–∞ (Data Scientist)

**–§–æ—Ä–º–∞—Ç:** Google Colab / Kaggle Notebook

**–¶–µ–ª—å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö ML-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç–µ–ª—å–Ω–æ–º pipeline